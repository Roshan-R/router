---
title: Containerizing the Apollo Router
description: Running Apollo Router images in containers
---

import ElasticNotice from '../../shared/elastic-notice.mdx';

<ElasticNotice />

Apollo provides container images of the Apollo Router [on GitHub](https://github.com/apollographql/router/pkgs/container/router).

Each release of the Apollo Router includes both default (production) and debug images. While each image for a release contains the same build, the debug images have helpful debugging utilities installed and run the router under the control of heaptrack (https://github.com/KDE/heaptrack).

## Example running router with Docker

To run the router, your Docker container must have the `APOLLO_GRAPH_REF` and `APOLLO_KEY` environment variables set to your graph's reference and ID, respectively. (TODO: link to env var reference)

- The reference of your graph in Apollo's registry (`<your-graph-ref>`).
-  The [graph API key](https://www.apollographql.com/docs/studio/api-keys/#graph-api-keys) that Apollo Server should use to authenticate with Apollo Studio. You can set this with the `APOLLO_KEY` environment variable. (`<your-graph-id>`).

- `graphRef`: A reference of your graph in Apollo's registry, such as `graph-id@my-variant` or just `graph-id`. You can set this with the `APOLLO_GRAPH_REF` environment variable.
- `graphId`: The ID of your graph in Apollo's registry. You can set this with the `APOLLO_GRAPH_ID` environment variable. You may not specify this if you specify the graph ref.

- Set your `APOLLO_GRAPH_REF` and `APOLLO_KEY` 

Here's a basic example of running a router image with Docker (make sure to replace `<image version>` with whichever version you want to use, such as `v1.4.0`):

```bash title="Docker"
docker run -p 4000:4000 \
  --env APOLLO_GRAPH_REF="<your graph>" \
  --env APOLLO_KEY="<your key>" \
  --rm \
  ghcr.io/apollographql/router:<image version>
```

This command downloads your supergraph schema from Apollo and uses a default configuration that listens for connections on port `4000`.

For more complex configuration (such as overriding subgraph URLs or propagating headers), see [Configuring the Apollo Router](../configuration/overview/).

For examples of using router images in specific environments, see the guides for [Docker](./docker/) and [Kubernetes](./kubernetes/).

## Image file layout

* The router executable is located in the `/dist` directory.
* A default configuration file, `router.yaml`, is located in the `dist/config` directory.
* There is also a `/dist/schema` directory for convenient mounting of a locally defined supergraph schema.
* Licensing details are also available in the `/dist` directory.

## Image build

Apollo Router images are based on [debian:bullseye-slim](https://hub.docker.com/_/debian/), which is designed to provide constrained, secure, and small images.
